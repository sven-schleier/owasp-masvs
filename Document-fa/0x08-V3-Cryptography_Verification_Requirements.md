<div dir="rtl" markdown="1">

# V3: الزامات رمزنگاری

## هدف کنترل

رمزنگاری یک جزء ضروری در حفاظت از داده‌ی ذخیره شده در گوشی موبایل می‌باشد. همچنین این دسته بندی، جایی است که ممکن است همه چیز به شکل وحشتناکی اشتباه پیش برود، به خصوص هنگامی که از قرداد‌های استاندارد پیروی نشود. هدف کنترل‌ها در این بخش این است که اطمینان حاصل کنند برنامه وارسی شده، از رمزنگاری طبق بهترین روش‌های صنعتی استفاده می‌کند، که شامل موارد زیر می‌شود:

- استفاده از کتابخانه‌های رمزنگاری ثابت شده؛

- انتخاب و پیکربندی مناسب اصول ابتدایی رمزنگاری؛

- تولید یک عدد تصادفی مناسب هرگاه که تصادفی بودن مورد نیاز است؛

## الزامات وارسی امنیت

| # | MSTG-ID | شرح | سطح یک | سطح دو |
| -- | ---------- | ---------------------- | - | - |
| **3.1** | MSTG-CRYPTO-1 | برنامه بر رمزنگاری متقارن با کلید‌های هارد‌کد شده، به عنوان تنها روش رمزگذاری، تکیه نمی کند.| x | x |
| **3.2** | MSTG-CRYPTO-2 | برنامه از پیاده سازی‌های به اثبات رسیده‌ی ابتدایی رمزنگاری استفاده می‌کند. | x | x |
| **3.3** | MSTG-CRYPTO-3 | برنامه از اصول ابتدایی رمزنگاری استفاده می کند که برای استفاده خاص مناسب هستند و با پارامترهایی که به بهترین روش‌های صنعتی پایبند هستند، پیکربندی شده‌اند.  | x | x |
| **3.4** | MSTG-CRYPTO-4 | برنامه از پروتکل‌ها یا الگوریتم‌های رمزنگاری که به دلایل امنیتی به طور گسترده منسوخ شناخته شده‌اند، استفاده نمی کند. | x | x |
| **3.5** | MSTG-CRYPTO-5 | برنامه از کلید رمزنگاری یکسان برای چندین عمل، استفاده نمی کند. | x | x |
| **3.6** | MSTG-CRYPTO-6 | تمام مقدارهای تصادفی با استفاده از یک تولید کننده عدد تصادفی به‌طور‌کافی امن تولید شده‌اند. | x | x |

## منابع

راهنمای وارسی امنیتی موبایل OWASP، دستورالعمل‌هایی مفصل برای تایید الزامات لیست شده در این بخش، فراهم می کند.

- Android: تست رمزنگاری  - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05e-Testing-Cryptography.md>
- iOS: تست رمزنگاری - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06e-Testing-Cryptography.md>

برای اطلاعات بیشتر همچنین مشاهده کنید:

- OWASP Mobile Top 10: M5 (رمزنگاری نامناسب) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography>
- CWE 310 (مشکلات رمزنگاری) - <https://cwe.mitre.org/data/definitions/310.html>
- CWE 321 (استفاده از کلید رمزنگاری هارد‌کد شده) - <https://cwe.mitre.org/data/definitions/321.html>
- CWE 326 (قدرت رمزنگاری ناکافی) - <https://cwe.mitre.org/data/definitions/326.html>
- CWE 327 (استفاده از الگوهای رمزنگاری پرخطر یا منقضی شده) - <https://cwe.mitre.org/data/definitions/327.html>
- CWE 329 (عدم استفاده از IV تصادفی به‌همراه حالت CBC) - <https://cwe.mitre.org/data/definitions/329.html>
- CWE 330 (استفاده از مقادیر تصادفی نامناسب) - <https://cwe.mitre.org/data/definitions/330.html>
- CWE 337 (جستجو قابل حدس در PRNG) - <https://cwe.mitre.org/data/definitions/337.html>
- CWE 338 (استفاده از رمزنگاری ضعیف تولید کننده‌ی جعلی اعداد تصادفی (PRNG)) - <https://cwe.mitre.org/data/definitions/338.html>

</div>
