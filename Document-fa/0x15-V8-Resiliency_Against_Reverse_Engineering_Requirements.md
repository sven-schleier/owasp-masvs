<div dir="rtl" markdown="1">

# V8: نیازمندی‌های انعطاف‌پذیری

## هدف کنترل

این بخش معیارهای دفاع در عمق توصیه شده برای اپلیکیشن‌هایی که اطلاعات حساس را پردازش کرده یا دسترسی به عملکرد یا اطلاعات حساس را فراهم می‌کنند را پوشش می‌دهد. نبود این کنترل‌ها باعث ایجاد آسیب‌پذیری نمی‌شود بلکه این کنترل‌ها به منظور افزایش انعطاف‌پذیری برنامه کاربردی در مقابل مهندسی معکوس و حملات خاص سمت کلاینت در نظر گرفته شده‌اند.

کنترل‌های این بخش باید بنا به نیاز و بر اساس ارزیابی مخاطرات به وجود آمده توسط دستکاری غیرمجاز برنامه و یا مهندسی معکوس کد اعمال شوند. برای مشاهده لیستی از مخاطرات کسب و کار و همچنین تهدیدات فنی مربوطه، پیشنهاد می‌کنیم که به سند OWASP با عنوان "مخاطرات فنی مهندسی معکوس و مهندسی معکوس تغییر غیر مجاز کد و جلوگیری از تغییر کد" مراجعه شود. (مراجع پایین را مشاهده کنید)

برای اینکه هر یک از کنترل‌های فهرست شده در لیست زیر مؤثر واقع شوند، اپلیکیشن باید حداقل تمام سطح یک MASVS  (یعنی کنترل‌های مستحکم امنیتی باید در سر جای خود باشند) و همچنین تمام نیازمندی‌های شماره‌گذاری شده با عدد پایین‌تر در V8 را برآورده سازد. به عنوان مثال، کنترل‌های obfuscation فهرست شده در زیر قسمت "منع درک کد" باید همراه با "منع تجزیه و تحلیل پویا و دستکاری" و "انقیاد دستگاه" ترکیب شوند

**توجه کنید که محافظت‌های نرم‌افزاری نباید هرگز به عنوان جایگزینی برای کنترل‌های امنیتی استفاده شوند. کنترل‌های فهرست شده در MASVR-R به منظور اضافه کردن کنترل‌های محافظتی اضافی و مربوط به تهدیدات خاص به برنامه‌هایی که نیازمندی‌های امنیتی MASVS را برآورده می‌کنند قرار داده شده‌اند.**

ملاحظات زیر قابل اجرا هستند:

1. یک مدل تهدید باید تعریف شود  که به طور روشن طرح کلی تهدیدات سمت کاربر که قرار است تعریف شوند را مشخص می‌کند. علاوه بر این، درجه محافظتی که طرح قرار است ارائه دهد باید مشخص شود. به عنوان مثال، یک هدف ذکر شده می‌تواند این باشد که سازندگان بدافزار هدف که به دنبال سوء استفاده از اپلیکیشن هستند را مجبور کنیم که برای مهندسی معکوس تلاش زیادی را متحمل شوند.

2. مدل تهدید باید معتبر و مناسب باشد. به عنوان مثال اگر یک مهاجم بتواند به راحتی کل جعبه سفید را سرقت کند، مخفی کردن یک کلید رمزنگاری در یک پیاده سازی جعبه سفید ممکن است کاری زائد باشد.

3. اثربخشی محافظت باید همیشه توسط یک متخصص انسانی دارای که داری تجربه در زمینه راه‌های جلوگیری از دستکاری برنامه و obfuscation است وارسی و تأیید شود (همچنین به بخش‌های "مهندسی معکوس" و "ارزیابی محافظت‌های نرم‌افزاری" از راهنمای آزمون امنیت موبایل مراجعه کنید).

<!-- \pagebreak -->

### منع تجزیه و تحلیل پویا و دستکاری برنامه

| # | MSTG-ID | شرح | R |
| -- | -------- | ---------------------- | - |
| **8.1** | MSTG-RESILIENCE-1 | برنامه روت بودن یا جیلبریک بودن گوشی را تشخیص داده و پاسخ مناسبی به آن بدهد. این پاسخ می‌تواند توسط هشدار به کاربر یا متوقف کردن برنامه انجام شود. | ✓ |
| **8.2** | MSTG-RESILIENCE-2 | اپلیکیشن از عیب‌یابی (debugging) جلوگیری کرده و یا موقع اتصال یک دیباگر آن را شناسایی کرده و پاسخ مناسب نسبت به آن می‌دهد.  تمام پروتکل‌های عیب‌یابی در دسترس باید تحت پوشش قرار گیرند. | ✓ |
| **8.3** | MSTG-RESILIENCE-3 | اپلیکیشن دستکاری فایل‌های اجرایی و داده‌های حساس درون جعبه شنی خود را تشخیص داده و به آن پاسخ می‌دهد. | ✓ |
| **8.4** | MSTG-RESILIENCE-4 | اپلیکیشن حضور ابزارها و چارچوب‌های پراستفاده مهندکسی معکوس را تشخیص داده و به آن پاسخ می‌دهد.| ✓ |
| **8.5** | MSTG-RESILIENCE-5 | اپلیکیشن اجرا شدن خود داخل شبیه‌ساز را تشخیص داده و به آن پاسخ می‌دهد.  | ✓ |
| **8.6** | MSTG-RESILIENCE-6 | اپلیکیشن تغییر کد و داده در فضای حافظه خودش را تشخیص داده و به آن پاسخ می‌دهد. | ✓ |
| **8.7** | MSTG-RESILIENCE-7 | اپلیکیشن مکانیزم‌های متعددی را در هر دسته دفاعی (8.1 تا 8.6) به کار می‌گیرد. توجه کنید که انعطاف‌پذیری با مقدار و تنوع اصالت مکانیزم‌های استفاده شده مقیاس می‌یابد. | ✓ |
| **8.8** | MSTG-RESILIENCE-8 | مکانیزم‌های تشخیص باعث فعال‌سازی پاسخ‌هایی از انواع مختلف می‌شوند از جمله پاسخ‌های با تأخیر و مخفی. | ✓ |
| **8.9** | MSTG-RESILIENCE-9 | عمل Obfuscation به دفاع‌های برنامه‌ای اعمال شده است که باعث جلوگیری از de-obfuscation توسط تجزیه و تحلیل پویا می‌شود.  | ✓ |

### انقیاد دستگاه

| # | MSTG-ID | شرح | R |
| -- | -------- | ---------------------- | - |
| **8.10** | MSTG-RESILIENCE-10 | اپلیکیشن از یک اثر انگشت دستگاه مشتق شده از ویژگی‌های متعدد یکتا مربوط به دستگاه کمک می‌گیرد و با آن یک عملکرد "انقیاد دستگاه" را پیاده سازی می‌کند. | ✓ |

<!-- \pagebreak -->

### منع درک کد

| # | MSTG-ID | شرح | R |
| -- | -------- | ---------------------- | - |
| **8.11** | MSTG-RESILIENCE-11 |تمام فایل‌های اجرایی و کتابخانه‌های متعلق به برنامه کاربردی یا در سطح فایل رمزنگاری شده‌اند و یا قسمت‌های مهم کد و داده درون فایل‌های اجرایی رمزنگاری یا pack شده‌اند. تجزیه و تحلیل جرئی ایستا کد یا داده مهمی را افشا نمی‌کند. | ✓ |
| **8.12** | MSTG-RESILIENCE-12 | با توجه به تحقیقات منتشر شده فعلی، اگر هدف obfuscation محافظت از ارتباطات حساس است، از یک طرح obfuscation استفاده شود که هم برای وظیفه خاص مناسب باشد و هم در مقابل روش‌های دستی و اتوماتیک de-obfuscation مقاوم باشد. اثربخشی طرح obfuscation باید از طریق آزمون دستی وارسی شود. توجه کنید که ویژگی‌های انزوای سخت‌افزاری در مقابل obfuscation در هر زمان ممکن دارای برتری هستند.  | ✓ |

### منع استراق سمع

| # | MSTG-ID | Description | R |
| -- | -------- | ---------------------- | - |
| **8.13** | MSTG-RESILIENCE-13 | در کنار محکم‌سازی قوی طرف‌های ارتباط، رمزنگاری payload سطح اپلیکیشن می‌تواند برای جلوگیری از استراق سمع بیشتر به عنوان یک دفاع عمیق اعمل شود. | ✓ |

<!-- \pagebreak -->

## منابع

راهنمای وارسی امنیتی موبایل OWASP، دستورالعمل‌هایی مفصل برای تایید نیازمندی‌های لیست شده در این بخش، فراهم می کند.

- Android: Testing Resiliency Against Reverse Engineering - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05j-Testing-Resiliency-Against-Reverse-Engineering.md>
- iOS: Testing Resiliency Against Reverse Engineering - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06j-Testing-Resiliency-Against-Reverse-Engineering.md>

برای اطلاعات بیشتر، مشاهده کنید:

- OWASP Mobile Top 10: M8 (Code Tampering) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m8-code-tampering>
- OWASP Mobile Top 10: M9 (Reverse Engineering) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m9-reverse-engineering>
- OWASP Reverse Engineering Threats - <https://wiki.owasp.org/index.php/Technical_Risks_of_Reverse_Engineering_and_Unauthorized_Code_Modification>
- OWASP Reverse Engineering and Code Modification Prevention - <https://wiki.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project>

</div>
